

# Workflow example 1: Automatically generate Dynamics 365 Guides deep links to use in an Excel Link Manager

This example shows you how to create a Link Manager for your guides in Microsoft Excel to easily keep track of your Microsoft Dynamics 365 guides. You can use the Link Manager to quickly launch a guide in the PC app by using the PC app link or in the HoloLens app by using the QR code link. The same workflow could be used for other scenarios like adding a link to a guide in an approval flow, embedding QR codes with links to guides in a work order, or in a learning management system.

The resulting Excel spreadsheet created with this tutorial looks like this:

SCREEN SHOT GOES HERE

## What you'll learn in this example

In this example you’ll learn how to do three key things:

- Use Power Automate to automatically populate a spreadsheet with content from your Dyanmics 365 Guides environment

- Automatically generate a deep link to a guide when the guide is created

- Automatically generate a QR code for the newly created guide

**Estimated time to create this workflow:** 10 minutes

## Create the Link Manager

Creating the Link Manager requires two basic steps:

- Create an Excel spreadsheet with the appropriate columns and formulas.

- Create a Power Automate flow that populates the data in the spreadsheet from Dynamics 365 Guides data stored in the Microsoft Dataverse.

## Create the Excel spreadsheet

The first step is to create an Excel spreadsheet that includes the columns you need for the Link Manager. Data for most of the columns will come from the Microsoft Dataverse (formerly known as Common Data Service). Two of the Excel columns will contain data concatenated from other cells in the spreadsheet. 

The following table shows the columns to add to the spreadsheet and where the data for each column will come from. 

|Excel column to add|Data source|
|---------------------------------------------|----------------------------------------------|
|User Name|	User Name (Microsoft Dataverse)|
|Guide Name	|Name (Microsoft Dataverse)|
|Guide Link (PC App)|	Concatenated value|
|QR Code Link (HoloLens App)|	Concatenated value|
|Created On	|Created On (Microsoft Dataverse)|
|Guide ID	|Guide (Microsoft Dataverse)|
|Created By|	User (Microsoft Dataverse)|

Make sure that after creating the columns that you select them and then select **Insert > Table**.

SCREEN SHOT GOES HERE

???What's the signficance of this???

### Create the concatenated value for the PC app link

To create the deep link for the PC app, you need to concatenate the deep link prefix for your instance URL with the Guide ID generated by Power Automate.

1.	To get the deeplink prefix for your instance URL, right-click any guide in the PC app, and then select **Copy link to this guide**.

    SCREEN SHOT GOES HERE
 
2.	Copy just the prefix part of the url to a cell in your spreadsheet (outside the area for the designated columns). For example, for the following instance url, the yellow highlighted text is the prefix.

    SCREEN SHOT GOES HERE

3.	In the **Guide Link (PC App)** column of the spreadsheet, add a formula that concatenates the deep link prefix with the Guide ID. For example, if you add the url prefix in cell K1, and the Guide ID is populated in column F, the formula for the **Guide Link (PC App) column** is: 

    =HYPERLINK(CONCAT($K$1,F2))

    This concatenation will happen whenever a guide is created and will automatically generate the link.
    
### Create the concatenated value for the HoloLens app link

To create the HoloLens app link, you need to concatenate the URL api from the QR code generator with the full deep link (PC app link). The form of the URL api is important. For example, here's a well-formed URL api:

https://api.qrserver.com/v1/create-qr-code/?qzone=4&size=1000x1000&bgcolor=666666&&data=

The following table describes important parts of the URL:

|URL part|Description|
|-------------------------------|-------------------------------------------------------------|
|**qzone=4**||
|**size=1000x1000**||
|**bgcolor=666666**||
|**data=**||

To concatenate this url with the deep link in column C, if the URL api is in cell K2, add the following formula to the **QR Code Link (HoloLens app)** column:

=HYPERLINK(CONCAT($K$2,C2))

## Create the Power Automate flow

After creating the Excel spreadsheet, you’re ready to populate the data in the spreadsheet by using Power Automate.

1. In Power Automate, select **Create**, and then select **Automated cloud flow**. Automated cloud flows are used to create an automation that’s triggered by an event.

    SCREEN SHOT GOES HERE

2. Enter a name for your flow, and then under **Choose your flow’s trigger**, scroll the list, select the **When a record is updated** trigger, and then select **Create**. 

    SCREEN SHOT GOES HERE
 
    > [!TIP] 
    > You can filter the list of triggers by entering “data” in the **Choose your flow’s trigger** box.

3. In the **When a record is updated trigger** box, select the environment where Dynamics 365 Guides is installed, select **Guides** as the entity name, and then select a scope.   

    SCREEN SHOT GOES HERE

4. Select **New step**, and then in the **Choose an operation** box, select **Common Data Service** to filter the list of actions.

    SCREEN SHOT GOES HERE
  
5. Select the **Get a row by ID** action. 

    SCREEN SHOT GOES HERE 

6. In the **Get a row by ID** action box, for the **Table name**, select **Users**, and then place your cursor in the **Row ID** field. When you place the cursor, the **Add dynamic content** box appears, which makes it easy to select the appropriate column from the Users table.

7. Select **Created By** from the **Dynamic content** list.

    SCREEN SHOT GOES HERE  

At this point, we’ve created a Power Automate flow that’s triggered whenever someone adds a record to the Guides table. The flow then uses the ID in the Guides table to look up the user who created the guide from the Users table. 

### Add the actions to populate the Excel spreadsheet from Microsoft Dataverse

Now you’re ready to set up the actions that populate the Excel spreadsheet columns. 

1. In the same flow, select **New step**, select **Excel Online (Business)** to filter the actions in the **Choose an operation** box, and then select **Add a row into a table**.

    SCREEN SHOT GOES HERE
  
2. In the **Add a row into a table** action, make the following selections:
 
|Option|Description|
|----------------------------|-------------------------------------------------------------|
|Location|	The location of your Excel file (for example, OneDrive for Business).|
|Document Library	|The document library where the Excel file is stored (for example, OneDrive).|
|File	|The name of your file (for example, Guide List.xlsx). You can browse to select the file.|
|Table|The table in the spreadsheet that you want to write the data to|
|Username	|User Name|
|Guide Name	|Name|
|Guide Link (PC app)|	Leave blank|
|QR code Link (HoloLens app)|	Leave blank|
|Created On|	Created On|
|Guide ID	|Guide|
|Created By	|User|

The following screen shot shows values filled in for the **Add a row into a table** action. 

## Idea for further customization

To further customize the Link Manager, you could set conditions in the Power Automate flow to populate a specific spreadsheet with the guides from a specific user so all of your power users have their own List Manager to work from. 

